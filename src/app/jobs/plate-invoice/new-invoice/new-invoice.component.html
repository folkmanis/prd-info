<div *ngIf="jobs$ | async as jobs;">

    <div *ngIf="totals$ | async as totals;" class="top-panel mat-elevation-z4">
        <!-- Aprēķina izveide un saņemšana -->
        <section class="selection">
            <mat-form-field>
                <mat-label>Klienta nosaukums</mat-label>
                <mat-select [formControl]="customerId">
                    <mat-option value="">Visi</mat-option>
                    <mat-option *ngFor="let customer of customers$ | async" [value]="customer.CustomerName">
                        {{customer.CustomerName}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
            <button mat-raised-button (click)="onCreateInvoice()" color="primary"
                [disabled]="customerId.invalid || !canSubmit || customerId.value ===''">
                APRĒĶINS
            </button>
            <button mat-raised-button (click)="onPrintList(jobs, customerId.value, totals)">
                IZDRUKĀT
            </button>
        </section>
        <section class="list">
            <p>
                <strong>
                    Kopā | {{totals.grandTotal | currency}}
                </strong>
            </p>
            <p *ngFor="let total of totals.totals">
                {{total._id}} | {{total.count}} | {{total.total | currency}}
            </p>
        </section>
    </div>
    <!-- Darbu atlase -->
    <section>
        <app-job-selection-table [jobs]="jobs" (selected)="onJobSelected($event)">
        </app-job-selection-table>
    </section>
</div>

<app-scroll-to-top position="fixed"></app-scroll-to-top>