<div class="tabula-container" cdk-scrollable>
  <div *ngIf="preferences$ | async as preferences;">
    <!-- Sākas tabula -->
    <table mat-table [dataSource]="dataSource$" [trackBy]="trackByFn" class="full-width-table mat-elevation-z8"
      aria-label="Kastes">

      <!-- Id Column -->
      <ng-container matColumnDef="kods">
        <th mat-header-cell *matHeaderCellDef>Nr</th>
        <td mat-cell *matCellDef="let row;" class="cipari">{{row.kods}}</td>
      </ng-container>

      <!-- Adrese sleja -->
      <ng-container matColumnDef="adrese">
        <th mat-header-cell *matHeaderCellDef mat>Adrese</th>
        <td mat-cell *matCellDef="let row;">{{row.adrese}} <span
            [class.label]="row.kastes.uzlime">({{row.kastes.total}})</span></td>
      </ng-container>

      <!-- Dzeltenā sleja -->
      <ng-container matColumnDef="yellow">
        <th mat-header-cell *matHeaderCellDef [style.color]="preferences.colors.yellow">Y</th>
        <td mat-cell *matCellDef="let row;" [style.color]="preferences.colors.yellow" class="cipari">
          {{row.kastes.yellow | hideZero}}
        </td>
      </ng-container>

      <!-- Rozā sleja -->
      <ng-container matColumnDef="rose">
        <th mat-header-cell *matHeaderCellDef [style.color]="preferences.colors.rose">R</th>
        <td mat-cell *matCellDef="let row;" [style.color]="preferences.colors.rose" class="cipari">
          {{row.kastes.rose | hideZero}}
        </td>
      </ng-container>

      <!-- Baltas sleja -->
      <ng-container matColumnDef="white">
        <th mat-header-cell *matHeaderCellDef [style.color]="preferences.colors.white">W</th>
        <td mat-cell *matCellDef="let row;" [style.color]="preferences.colors.white" class="cipari">
          {{row.kastes.white | hideZero}}</td>
      </ng-container>
      <!-- Gatavs -->
      <ng-container matColumnDef="gatavs">
        <th mat-header-cell *matHeaderCellDef>
          <div>
            Gatavs
          </div>
        </th>
        <td mat-cell *matCellDef="let row;">
          <div>
            <mat-checkbox MatCheckboxClickAction='noop' (click)="onGatavs(row)" color="accent"
              [checked]="row.kastes.gatavs" *ngIf="!row.loading;"> </mat-checkbox>
            <mat-spinner *ngIf="row.loading;" [diameter]="32"></mat-spinner>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns;"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="selectedKaste=row"
        [class.selected]="row === selectedKaste"></tr>
    </table>
    <div class="blank"></div>
  </div>
  <app-scroll-to-top position="fixed"></app-scroll-to-top>
</div>