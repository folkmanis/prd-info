<mat-horizontal-stepper linear>
    <!-- csv ielāde -->
    <mat-step [completed]="!!parsedJobs" [editable]="false">
        <ng-template matStepLabel>.csv faila izvēle</ng-template>
        <div class="pogas">
            <button mat-raised-button matStepperNext color="primary" (click)="onCsvUploaded()"
                type="button">Tālāk</button>
            <button mat-raised-button (click)="restoreParsedJobs()">Atjaunot</button>
        </div>
        <div class="drope" appFileDrop (filesEmitter)="onFileDrop($event)"></div>
    </mat-step>
    <!-- Jaunie klienti -->
    <mat-step [stepControl]="customersForm" [editable]="false">
        <ng-template matStepLabel>Trūkstošo klientu pievienošana</ng-template>
        <div class="pogas">
            <button mat-raised-button matStepperNext color="primary" (click)="onCustomersComplete()">Tālāk</button>
            <button mat-raised-button (click)="savePersistence()">Saglabāt</button>
            <button mat-raised-button matStepperNext (click)="restoreCustomers()">Atjaunot</button>
        </div>
            <app-import-new-customers [customersForm]="customersForm" [missingCodes]="missingCustomers">
            </app-import-new-customers>
    </mat-step>
    <!-- Jaunas preces -->
    <mat-step [stepControl]="productsForm" [editable]="false">
        <ng-template matStepLabel>Trūkstošo preču pievienošana</ng-template>
        <div class="pogas">
            <button mat-raised-button matStepperNext color="primary" (click)="onProductsComplete()">Tālāk</button>
            <button mat-raised-button (click)="savePersistence()">Saglabāt</button>
            <button mat-raised-button matStepperNext (click)="restoreProducts()">Atjaunot</button>
        </div>
        <section>
            <h4 *ngIf="missingProducts.length > 0; else noMissing">
                Tiks pievienota šādas trūkstošās preces
            </h4>
            <ng-template #noMissing>Visas preces atrastas datubāzē</ng-template>
        </section>
        <mat-list>
            <mat-list-item *ngFor="let prod of productsForm.controls; index as idx;">
                {{prod.get('name').value}}
                <mat-form-field class="products">
                    <mat-label>Kategorija*</mat-label>
                    <mat-select [formControl]="prod.get('category')">
                        <mat-option *ngFor="let cat of categories$ | async" [value]="cat.category">
                            {{cat.description}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <mat-form-field class="products">
                    <mat-label>Apraksts</mat-label>
                    <input matInput type="text" [formControl]="prod.get('description')">
                </mat-form-field>
            </mat-list-item>
        </mat-list>
    </mat-step>
    <!-- Trūkstošās preču cenas -->
    <mat-step [editable]="false" [stepControl]="pricesForm">
        <ng-template matStepLabel>Trūkstošo cenu pievienošana</ng-template>
        <div class="pogas">
            <button mat-raised-button matStepperNext (click)="onPricesComplete()">Tālāk</button>
            <button mat-raised-button (click)="savePersistence()">Saglabāt</button>
            <button mat-raised-button matStepperNext (click)="restorePrices()">Atjaunot</button>
        </div>
        <div>
            <app-import-new-prices [pricesForm]="pricesForm" [products]="missingPrices"></app-import-new-prices>
        </div>
    </mat-step>
    <!-- Visi darbi apstiprināšanai -->
    <mat-step [editable]="false">
        <ng-template matStepLabel>Darbi importam</ng-template>
        <div class="pogas">
            <button mat-raised-button color="accent" (click)="onUploadJobs()">Saglabāt datubāzē</button>
        </div>
        <div>
            <app-import-new-jobs [jobs]="jobsToUpload"></app-import-new-jobs>
        </div>
    </mat-step>
</mat-horizontal-stepper>