<form [formGroup]="priceForm" (submit)="acceptEdit()">
    <table mat-table [dataSource]="prices$" class="full-width">
        <!-- Klients -->
        <ng-container matColumnDef="customerName">
            <th mat-header-cell *matHeaderCellDef>Klients</th>
            <td mat-cell *matCellDef="let customer;">
                <div *ngIf="customer !== edit || customer.customerName; else nameEdit">
                    {{customer.customerName}}
                </div>
                <ng-template #nameEdit>
                    <!-- Klients ar labošanu -->
                    <mat-form-field>
                        <mat-select formControlName="customerName">
                            <mat-option *ngFor="let customer of customersFiltered$ | async"
                                [value]="customer.CustomerName">
                                {{customer.CustomerName}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </ng-template>
            </td>
        </ng-container>
        <!-- Cena -->
        <ng-container matColumnDef="price">
            <th mat-header-cell *matHeaderCellDef>Cena</th>
            <td mat-cell *matCellDef="let customer;">
                <div *ngIf="customer !== edit; else priceEdit" (click)="onEditRow(customer)">
                    {{customer.price | currency}}
                </div>
                <!-- Cena labojama -->
                <ng-template #priceEdit>
                    <mat-form-field class="price">
                        <input matInput formControlName="price" type="number">
                    </mat-form-field>
                </ng-template>
            </td>
        </ng-container>
        <!-- Pogas -->
        <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let customer;">
                <div *ngIf="customer !== edit; else actionEdit">
                    <button mat-icon-button color="warn" (click)="onDeleteRow(customer)" [disabled]="edit">
                        <mat-icon>remove_circle</mat-icon>
                    </button>
                </div>
                <!-- pogas labošanas režīmā -->
                <ng-template #actionEdit>
                    <!-- Apstiprināt -->
                    <button mat-icon-button type="submit" [disabled]="!priceForm.valid">
                        <mat-icon>check_circle</mat-icon>
                    </button>
                    <!-- Atcelt -->
                    <button mat-icon-button (click)="cancelEdit()">
                        <mat-icon>cancel</mat-icon>
                    </button>
                </ng-template>
            </td>
        </ng-container>
        <!-- Beigu rinda ar pogām -->
        <ng-container matColumnDef="addRow">
            <td mat-footer-cell *matFooterCellDef colspan="columns.length">
                <button mat-icon-button (click)="onAppendPrice()" [disabled]="edit">
                    <mat-icon>add_circle</mat-icon>
                </button>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="columns"></tr>
        <tr mat-row *matRowDef="let row; columns: columns"></tr>
        <tr mat-footer-row *matFooterRowDef="['addRow']"></tr>
    </table>
</form>